<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <script type="text/javascript" src="js/tetrix_model.js"></script>
        <script type="text/javascript" src="js/tetrix_view.js"></script>
        <script type="text/javascript">
            window.onload = function() {        
                var tetrixBox = new TetrixBox();
        
                var images = [];
                for(var i = 0; i < 7; i++) {
                    images[i] = new Image();
                    images[i].src = 'images/' + (i + 1) + '.jpg';
                }
        
                tetrixBox.setBackgroundColor(rgb(0, 0, 0));
                tetrixBox.setTetrixImages(images);
                tetrixBox.next();
        
                var tetrixGround = new TetrixGround(10, 20);
                tetrixGround.addPieceOfType(tetrixBox.getTetrixPiece().type);
        
                var stackArea = new TetrixStackArea(tetrixBox, tetrixGround);
                var canvas1 = document.getElementById('canvas1');
                canvas1.width = stackArea.getWidth();
                canvas1.height = stackArea.getHeight();
                
                var context = canvas1.getContext('2d');
                
                setTimeout(function() {
                    if(tetrixGround.isMovable(0, 1)) {
                        tetrixGround.moveTetrixRight();
                        tetrixGround.moveTetrixDown();
                        tetrixGround.updateGround();
                        stackArea.paint(context);
                    }
                    else {
                        tetrixGround.addPieceOfType(tetrixBox.getTetrixPiece().type);
                        tetrixBox.next();
                    }
                    
                    setTimeout(arguments.callee, 100);
                }, 100);
            };
        </script>
    </head>
    <body>       
        <canvas id="canvas1" style="border-width: 1px; border-style: solid;"></canvas>
    </body>
</html>